----item----
version: 1
id: {4DFBE0BE-90F2-4842-99ED-D32A5E35E1D6}
database: master
path: /sitecore/system/Modules/PowerShell/Script Library/Platform/Development/Integration libraries maintenance/Event Handlers/Create libraries for all events
parent: {29F31D23-75B4-445D-A7E5-DF3370D21933}
name: Create libraries for all events
master: {00000000-0000-0000-0000-000000000000}
template: {DD22F1B3-BD87-4DB2-9E7D-F7A496888D43}
templatekey: PowerShell Script

----field----
field: {B1A94FF0-6897-47C0-9C51-AA6ACB80B1F0}
name: Script
key: script
content-length: 1625

<#
   The script enumerates events definitions in web.config and creates appropriate folder structure 
   in the PowerShell Module script library to add support for them
#>

$integrationPoint = [Cognifide.PowerShell.PowerShellIntegrations.Modules.IntegrationPoints]::EventHandlersFeature;
Import-Function -Name Create-IntegrationPoint

if($module -eq $null){
    $module = Get-Item "master:/sitecore/system/Modules/PowerShell/Script Library"
    $result = Read-Variable -Parameters `
        @{ Name = "module"; Title="Module to add Script Libraries to"; Root="/sitecore/system/Modules/PowerShell/Script Library" } `
        -Description "Pick a module that you will be creating your event handlers in. When you press OK all possible event handler script libraries will be created. You can clean up empty ones after with the other script in the same library" `
        -Title "Pick a module to populate" -Width 500 -Height 450 -OkButtonName "Proceed" -CancelButtonName "Abort" -ShowHints
    if($result -ne "ok")
    {
        Exit
    }
}

$nodes = [Sitecore.Configuration.Factory]::GetConfigNodes("events/event");
$i = 0;
foreach ($eventnode in $nodes)
{
    $eventName = [Sitecore.Xml.XmlUtil]::GetAttribute("name", $eventNode);
    $eventName = [System.Threading.Thread]::CurrentThread.CurrentCulture.TextInfo.ToTitleCase($eventName.Replace(":","/"));
    $EventPath = "$($module.ProviderPath)/$($integrationPoint.Path)/$($eventName)"
    $i++
    Write-Progress -Activity "Creating Event nodes" -PercentComplete ($i*100/$nodes.Count) -CurrentOperation "Creating node $eventName"
    CreatePathRecursively ($EventPath);
}
----version----
language: en
version: 1
revision: c7fbafb9-fde4-4b93-8993-6ee860ca22f0

----field----
field: {25BED78C-4957-4165-998A-CA1B52F67497}
name: __Created
key: __created
content-length: 15

20130525T223024
----field----
field: {8CDC337E-A112-42FB-BBB4-4143751E123F}
name: __Revision
key: __revision
content-length: 36

c7fbafb9-fde4-4b93-8993-6ee860ca22f0
----field----
field: {D9CF14B1-FA16-4BA6-9288-E8A174D4D522}
name: __Updated
key: __updated
content-length: 34

20141203T021633:635531697937082187
----field----
field: {BADD9CF9-53E0-4D0C-BCC0-2D784C282F6A}
name: __Updated by
key: __updated by
content-length: 14

sitecore\admin
